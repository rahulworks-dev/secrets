<ion-content
  [fullscreen]="true"
  class="ion-padding-horizontal dashboard"
  *ngIf="!hasNoSecrets"
>
  <div class="my-folders" *ngIf="folders && folders?.length > 0">
    <div
      class="my-folders-header d-flex ion-justify-content-between ion-align-items-center"
    >
      <h2>My Folders</h2>
      <p [routerLink]="'/folders'" *ngIf="folders && folders?.length > 4">
        View All
      </p>
    </div>

    <div class="my-folders-list">
      <div
        class="folder"
        *ngFor="let item of folders.slice(0,4)"
        [ngStyle]="{'backgroundColor' : item?.folderColor}"
      >
        <div class="folder-tab"></div>
        <div
          class="folder-line-1"
          [ngStyle]="{'background': 'linear-gradient(45deg, ' + item?.folderColor + ' 50%, #030619 50%)'}"
        ></div>
        <div
          class="folder-line-2"
          [ngStyle]="{'backgroundColor' : item?.folderColor}"
        ></div>
        <div class="folder-line-3"></div>

        <div class="content">
          <p>{{item?.folderName}}</p>
        </div>
      </div>
    </div>
  </div>

  <div class="my-secrets">
    <div
      class="my-secrets-header d-flex ion-justify-content-between ion-align-items-center"
    >
      <h2>My Secrets</h2>
      <p (click)="onReveal()">{{ isRevealed ? 'Reset' : 'Revel All'}}</p>
    </div>

    <ng-container *ngIf="(loaderService.isLoading$ | async) === true">
      <ion-card
        class="skeleton-secrets ion-no-padding my-secrets-content"
        *ngFor="let secret of [1,2]"
      >
      </ion-card>
    </ng-container>

    <ng-container *ngIf="(loaderService.isLoading$ | async) === false">
      <ion-card
        class="ion-no-padding my-secrets-content"
        *ngFor="let secret of secrets; let index = index"
      >
        <ion-card-header *ngIf="secret?.title">
          <ion-card-title>
            <p class="blur" [class.revealed]="isRevealed">{{secret?.title}}</p>
            <div
              class="actions d-flex justify-content-center align-items-center"
            >
              <ion-icon
                name="create-outline"
                (click)="onEdit(secret?.id)"
              ></ion-icon>
              <ion-icon
                name="trash-outline"
                color="danger"
                (click)="onDelete(secret?.id)"
              ></ion-icon>
              <ion-icon name="ellipsis-vertical"></ion-icon>
            </div>
          </ion-card-title>
        </ion-card-header>

        <ion-card-content
          (click)="onCopy(secret?.secret)"
          *ngIf="secret?.secret?.includes('http'); else notalink"
        >
          <div class="d-flex justify-content-center align-items-start">
            <ion-icon name="lock-closed"></ion-icon>
            <a
              [href]="secret?.secret"
              target="_blank"
              rel="noopener noreferrer"
              class="blur pl-5"
              [class.revealed]="isRevealed"
            >
              {{secret?.secret}}</a
            >
          </div>
          <small>Created on {{secret?.createdOn | date:'short'}}</small>
        </ion-card-content>
        <ng-template #notalink>
          <ion-card-content (click)="onCopy(secret?.secret)">
            <div class="d-flex justify-content-center align-items-start">
              <ion-icon
                name="lock-closed-outline"
                *ngIf="!isRevealed"
              ></ion-icon>
              <ion-icon name="lock-open-outline" *ngIf="isRevealed"></ion-icon>
              <p class="blur pl-5" [class.revealed]="isRevealed">
                {{secret?.secret}}
              </p>
            </div>
            <small>Created on {{secret?.createdOn | date:'medium'}}</small>
          </ion-card-content>
        </ng-template>
      </ion-card>
    </ng-container>
  </div>

  <div class="ete" *ngIf="secrets && secrets?.length > 0">
    <ion-icon name="lock-closed"></ion-icon>
    <p class="pl-5">Your secrets are <span>end-to-end encrypted</span></p>
  </div>
</ion-content>

<ion-content *ngIf="hasNoSecrets">
  <div class="no-secrets">
    <img src="../../../assets/images/no-secrets.webp" alt="" />
    <p>No Secrets Added, Click on '+' to add your first secret</p>
  </div>
</ion-content>

<div>
  <ion-icon name="add-circle" class="plus" (click)="onAdd()"></ion-icon>
  <ion-modal
    id="add-folder-modal"
    [isOpen]="isModalOpen"
    (willDismiss)="onWillDismiss($event)"
  >
    <ng-template>
      <div class="wrapper">
        <h1>Create Folder</h1>
        <div class="content">
          <ion-input
            placeholder="Enter Folder Name"
            [(ngModel)]="folderName"
          ></ion-input>
          <ion-button expand="block" (click)="onFolderCreation()"
            >Submit</ion-button
          >
        </div>
      </div>
    </ng-template>
  </ion-modal>
</div>
